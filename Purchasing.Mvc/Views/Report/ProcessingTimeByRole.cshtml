@using Newtonsoft.Json
@model Purchasing.Mvc.Controllers.ReportProcessingTimeByRoleViewModel

@{
    ViewBag.Title = "ProcessingTimeByRole";
}

<h2>ProcessingTimeByRole</h2>

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-more.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="height: 400px; margin: auto; min-width: 310px; max-width: 600px"></div>

<script>
    var names =  @Html.Raw(JsonConvert.SerializeObject(Model.Columns.NamesInRole));
    var times =  @Html.Raw(JsonConvert.SerializeObject(Model.Columns.PercentilesForRole ));
    $(function () {
        $('#container').highcharts({

            chart: {
                type: 'boxplot'
            },

            title: null,

            legend: {
                enabled: false
            },

            xAxis: {
                categories: names,
                title: {
                    text: 'User: '
                }
            },

            yAxis: {
                title: {
                    text: 'Time to Complete'
                },
                min: 0,
                plotLines: [{
                    value: @Model.Columns.AverageTimeToRoleComplete,
                    color: 'red',
                    width: 1,
                    label: {
                        text: 'Overall mean: ' +  @String.Format("{0:F2}", Model.Columns.AverageTimeToRoleComplete),
                        align: 'center',
                        style: {
                            color: 'gray'
                        }
                    }
                }]
            },
            credits: {
                enabled: false
            },
            series: [{
                name: 'Observations',
                data: times,
                tooltip: {
                    headerFormat: '<em>User {point.key}</em><br/>'
                }
            }, {
                name: 'Outlier',
                color: Highcharts.getOptions().colors[0],
                type: 'scatter',
                marker: {
                    fillColor: 'white',
                    lineWidth: 1,
                    lineColor: Highcharts.getOptions().colors[0]
                },
                tooltip: {
                    pointFormat: 'Observation: {point.y}'
                }
            }]

        });
    });
</script>