@using Purchasing.Web.Models
@model WorkgroupVendorViewModel

@{
    ViewBag.Title = "Create Workgroup Vendor";
}

@section SubNav
{
	<ul class="navigation">
		<li>@Html.ActionLink("Back to List", "VendorList", new { Id = Model.WorkgroupVendor.Workgroup.Id })</li>
	</ul>
}

@section AdditionalScripts
{
    <script type="text/javascript">

        var addressUrl = '@Url.Action("GetVendorAddresses")';

        $(function () {

            // what to do when a kfs vendor is selected
            $("#WorkgroupVendor_VendorId").change(function () {

                var $addressSelect = $("#WorkgroupVendor_VendorAddressTypeCode");
                $addressSelect.find("option:gt(0)").remove();

                if ($(this).val() != "") {

                    $.getJSON(addressUrl, { vendorId: $(this).val() }, function (result) {

                        // perform work if any results come back
                        if (result.length > 0) {

                            $.each(result, function (index, item) {

                                var option = $("<option>").val(item.TypeCode).html(item.Name);
                                $addressSelect.append(option);

                            });

                        }
                    });
                }
            });

            // selecting a type of vendor
            $(".vendorType").click(function () {
                
                // new vendor
                if ($(this).val() == "true") {
                    $("#kfsVendorForm").hide();
                    $("#newVendorForm").show();
                }
                // existing vendor
                else {
                    $("#kfsVendorForm").show();
                    $("#newVendorForm").hide();
                }

            });

        });

    </script>

    <style type="text/css">
    form select {width: 600px;}
    </style>
}

<section class="ui-corner-all display-form">
    
    <header class="ui-corner-top ui-widget-header">Type of Vendor to Add</header>

    <div class="section-text">
        Please select the type of vendor you would like to add to the workgroup.
    </div>

    <ul>
        <li><input type="radio" name="newVendor" value="false" class="vendorType" @(Model.NewVendor.HasValue && !Model.NewVendor.Value ? @"checked" : string.Empty)/> Existing Kfs Vendor</li>
        <li><input type="radio" name="newVendor" value="true"  class="vendorType" @(Model.NewVendor.HasValue && Model.NewVendor.Value ? @"checked" : string.Empty)/> New Vendor</li>
    </ul>

</section>

<div id="kfsVendorForm" @(Model.NewVendor.HasValue && !Model.NewVendor.Value ? "style=display:block;" : "style=display:none;")>

    @Html.Partial("_ExistingWorkgroupVendor")

</div>

<div id="newVendorForm" @(Model.NewVendor.HasValue && Model.NewVendor.Value ? "style=display:block;" : "style=display:none;")>

    @Html.Partial("_NewWorkgroupVendor")

</div>